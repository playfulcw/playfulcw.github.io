<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Trivia Bingo - Playful</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Franklin+Gothic+Medium&display=swap"
      rel="stylesheet"
    />
    <style>
      /* Design System Variables */
      :root {
        /* Colors */
        --primary: #6fc4ee;
        --secondary: #f79552;
        --success: #8dc757;
        --warning: #ffcd2f;
        --error: #ef4a88;
        --purple: #9579b3;
        --dark: #252626;
        --light: #dbdada;
        --white: #ffffff;

        /* Typography */
        --font-xs: 0.75rem;
        --font-sm: 0.875rem;
        --font-base: 1.0625rem;
        --font-lg: 1.25rem;
        --font-xl: 1.5rem;
        --font-2xl: 2rem;
        --font-3xl: 2.5rem;
        --font-4xl: 3.25rem;

        --font-light: 300;
        --font-normal: 400;
        --font-medium: 500;
        --font-semibold: 600;
        --font-bold: 700;

        --leading-tight: 1.25;
        --leading-snug: 1.375;
        --leading-normal: 1.5;
        --leading-relaxed: 1.625;

        /* Spacing */
        --space-1: 0.25rem;
        --space-2: 0.5rem;
        --space-3: 0.75rem;
        --space-4: 1rem;
        --space-5: 1.25rem;
        --space-6: 1.5rem;
        --space-8: 2rem;
        --space-10: 2.5rem;
        --space-12: 3rem;
        --space-16: 4rem;

        /* Border Radius */
        --radius-sm: 0.5rem;
        --radius-md: 1rem;
        --radius-lg: 1.25rem;

        /* Shadows */
        --shadow-xs: 0 1px 2px rgba(37, 38, 38, 0.05);
        --shadow-sm: 0 1px 3px rgba(37, 38, 38, 0.08);
        --shadow-md: 0 2px 6px rgba(37, 38, 38, 0.1);
        --shadow-hover: 0 4px 12px rgba(37, 38, 38, 0.12);
        --shadow-active: 0 6px 20px rgba(37, 38, 38, 0.15);
      }

      /* Apple-style Animation System */
      .animate {
        -webkit-animation-duration: 0.6s;
        animation-duration: 0.6s;
        -webkit-animation-fill-mode: both;
        animation-fill-mode: both;
        -webkit-animation-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        animation-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        pointer-events: none;
      }

      .delay-1 {
        -webkit-animation-delay: 0.1s;
        animation-delay: 0.1s;
      }

      /* Gentle Settle Animation */
      @-webkit-keyframes gentleSettle {
        0% {
          opacity: 0;
          -webkit-transform: translateY(20px);
          transform: translateY(20px);
        }
        100% {
          opacity: 1;
          -webkit-transform: translateY(0);
          transform: translateY(0);
        }
      }
      @keyframes gentleSettle {
        0% {
          opacity: 0;
          -webkit-transform: translateY(20px);
          transform: translateY(20px);
        }
        100% {
          opacity: 1;
          -webkit-transform: translateY(0);
          transform: translateY(0);
        }
      }

      .gentleSettle {
        -webkit-animation-name: gentleSettle;
        animation-name: gentleSettle;
      }

      /* Custom Scrollbar Styling */
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }

      ::-webkit-scrollbar-track {
        background: transparent;
      }

      ::-webkit-scrollbar-thumb {
        background: rgba(37, 38, 38, 0.3);
        border-radius: 4px;
      }

      /* Firefox scrollbar */
      * {
        scrollbar-width: thin;
        scrollbar-color: rgba(37, 38, 38, 0.3) transparent;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI",
          Roboto, sans-serif;
        font-size: var(--font-base);
        font-weight: var(--font-normal);
        line-height: var(--leading-normal);
        color: var(--dark);
        background-color: #fafafa;
        overflow-x: hidden;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        position: relative;
      }

      /* Soft Geometric Background Patterns */
      body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: -1;
        background: radial-gradient(
            ellipse 120px 80px at 15% 25%,
            rgba(111, 196, 238, 0.08) 0%,
            transparent 50%
          ),
          radial-gradient(
            ellipse 90px 140px at 85% 15%,
            rgba(247, 149, 82, 0.06) 0%,
            transparent 50%
          ),
          radial-gradient(
            ellipse 100px 60px at 25% 75%,
            rgba(141, 199, 87, 0.06) 0%,
            transparent 50%
          ),
          radial-gradient(
            ellipse 80px 100px at 75% 85%,
            rgba(149, 121, 179, 0.06) 0%,
            transparent 50%
          ),
          radial-gradient(
            ellipse 60px 90px at 50% 40%,
            rgba(111, 196, 238, 0.04) 0%,
            transparent 50%
          );
        background-size: 300px 200px, 250px 280px, 280px 160px, 200px 250px,
          180px 220px;
        background-repeat: no-repeat;
        pointer-events: none;
      }

      body::after {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: -1;
        background: radial-gradient(
            ellipse 70px 110px at 65% 60%,
            rgba(247, 149, 82, 0.05) 0%,
            transparent 50%
          ),
          radial-gradient(
            ellipse 110px 70px at 35% 20%,
            rgba(141, 199, 87, 0.05) 0%,
            transparent 50%
          ),
          radial-gradient(
            ellipse 85px 120px at 80% 45%,
            rgba(111, 196, 238, 0.04) 0%,
            transparent 50%
          );
        background-size: 220px 180px, 260px 140px, 200px 240px;
        background-repeat: no-repeat;
        pointer-events: none;
      }

      /* Typography with tight kerning */
      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        letter-spacing: -0.04em;
      }

      /* Header */
      .header {
        background: var(--white);
        border-bottom: 1px solid #f0f0f0;
        box-shadow: var(--shadow-xs);
        position: sticky;
        top: 0;
        z-index: 100;
        flex-shrink: 0;
      }

      .nav {
        max-width: 1400px;
        margin: 0 auto;
        padding: var(--space-3) var(--space-4);
        display: grid;
        grid-template-columns: 1fr auto 1fr;
        align-items: center;
        gap: var(--space-4);
      }

      .nav-left {
        display: flex;
        justify-content: flex-start;
      }

      .nav-center {
        display: flex;
        justify-content: center;
      }

      .nav-right {
        display: flex;
        justify-content: flex-end;
        /* Reserved for future features like search */
      }

      .logo {
        display: flex;
        align-items: center;
        text-decoration: none;
        opacity: 1;
        gap: var(--space-3);
      }

      .logo-icon {
        height: 32px;
        width: 32px;
        flex-shrink: 0;
      }

      .logo-text {
        font-size: var(--font-xl);
        font-weight: var(--font-semibold);
        color: var(--dark);
        letter-spacing: -0.04em;
      }

      .menu-button {
        background: none;
        border: none;
        cursor: pointer;
        padding: var(--space-2);
        border-radius: var(--radius-sm);
        transition: background-color 0.2s ease;
        display: flex;
        flex-direction: column;
        gap: 3px;
        width: 24px;
        height: 24px;
        justify-content: center;
      }

      .menu-button:hover {
        background: rgba(111, 196, 238, 0.1);
      }

      .menu-line {
        width: 16px;
        height: 2px;
        background: var(--dark);
        border-radius: 1px;
        transition: all 0.3s ease;
      }

      /* Close button in sidebar */
      .sidebar-close {
        position: absolute;
        top: var(--space-3);
        right: var(--space-4);
        background: var(--white);
        border: none;
        cursor: pointer;
        padding: 0;
        border-radius: 50%;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 32px;
        height: 32px;
        box-shadow: 0 2px 4px rgba(37, 38, 38, 0.1);
      }

      .sidebar-close:hover {
        background: #f8f8f8;
        transform: scale(1.1);
        box-shadow: 0 2px 8px rgba(37, 38, 38, 0.15);
      }

      .sidebar-close::before {
        content: "";
        position: absolute;
        width: 12px;
        height: 2px;
        background: var(--dark);
        border-radius: 1px;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) rotate(45deg);
      }

      .sidebar-close::after {
        content: "";
        position: absolute;
        width: 2px;
        height: 12px;
        background: var(--dark);
        border-radius: 1px;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) rotate(45deg);
      }

      /* Desktop Navigation */
      .nav-desktop {
        display: block;
      }

      .sidebar-desktop {
        position: fixed;
        top: 0;
        left: -320px;
        width: 320px;
        height: 100vh;
        background: var(--dark);
        z-index: 200;
        transition: left 0.4s cubic-bezier(0.23, 1, 0.32, 1);
        overflow-y: auto;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15),
          0 20px 48px rgba(0, 0, 0, 0.15), 0 1px 4px rgba(0, 0, 0, 0.15);
      }

      .sidebar-desktop.open {
        left: 0;
      }

      /* Mobile Navigation */
      .nav-mobile {
        display: none;
      }

      .sidebar-mobile {
        position: fixed;
        top: 0;
        left: -100vw;
        width: 100vw;
        height: 100vh;
        background: var(--dark);
        z-index: 200;
        transition: left 0.4s cubic-bezier(0.23, 1, 0.32, 1);
        overflow-y: auto;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15),
          0 20px 48px rgba(0, 0, 0, 0.15), 0 1px 4px rgba(0, 0, 0, 0.15);
      }

      .sidebar-mobile.open {
        left: 0;
      }

      .sidebar-content {
        padding: var(--space-6);
        padding-top: 114px;
      }

      .sidebar-section {
        margin-bottom: var(--space-8);
      }

      .sidebar-section h3 {
        font-size: var(--font-sm);
        font-weight: var(--font-semibold);
        color: var(--white);
        margin-bottom: var(--space-4);
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .sidebar-nav {
        list-style: none;
      }

      .sidebar-nav li {
        margin-bottom: var(--space-2);
      }

      .sidebar-nav a {
        display: block;
        padding: var(--space-2) var(--space-3);
        color: var(--white);
        text-decoration: none;
        border-radius: var(--radius-sm);
        transition: all 0.2s ease;
        font-weight: var(--font-normal);
        font-size: var(--font-sm);
      }

      .sidebar-nav a:hover {
        background: rgba(255, 255, 255, 0.1);
        color: var(--white);
      }

      /* Overlay for dimming and blurring content */
      .overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(37, 38, 38, 0.4);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        z-index: 150;
        opacity: 0;
        visibility: hidden;
        transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
      }

      .overlay.active {
        opacity: 1;
        visibility: visible;
      }

      /* Main Content */
      .main {
        max-width: 1400px;
        margin: 0 auto;
        padding: 0 var(--space-6);
        width: 100%;
        display: flex;
        flex-direction: column;
        padding-top: 60px;
        flex: 1;
      }

      .game-content {
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        align-items: center;
        min-height: calc(100vh - 60px);
        padding-top: var(--space-8);
        padding-bottom: var(--space-6);
      }

      /* Game Container - Single Card Design */
      .game-container {
        background: var(--white);
        border: 2px solid #e5e7eb;
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-md);
        overflow: hidden;
        max-width: 900px;
        width: 100%;
        margin-bottom: var(--space-8);
        padding: var(--space-8);
      }

      /* Game Header */
      .game-header {
        text-align: center;
        margin-bottom: var(--space-8);
      }

      .game-header h1 {
        font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
        font-size: var(--font-4xl);
        font-weight: 500;
        color: var(--dark);
        margin-bottom: var(--space-2);
        letter-spacing: -0.04em;
      }

      .game-subtitle {
        font-size: var(--font-lg);
        color: #666;
        font-weight: var(--font-normal);
        line-height: var(--leading-snug);
        margin-bottom: var(--space-4);
      }

      .game-instructions {
        display: flex;
        gap: var(--space-2);
        justify-content: center;
        flex-wrap: wrap;
      }

      .instruction-link {
        padding: var(--space-2) var(--space-4);
        background: var(--primary);
        color: var(--white);
        text-decoration: none;
        border-radius: var(--radius-sm);
        font-size: var(--font-sm);
        font-weight: var(--font-medium);
        transition: all 0.2s ease;
        box-shadow: var(--shadow-xs);
      }

      .instruction-link:hover {
        background: #5bb3e6;
        transform: translateY(-1px);
        box-shadow: var(--shadow-hover);
      }

      .reset-link {
        padding: var(--space-2) var(--space-4);
        background: var(--white);
        color: var(--dark);
        text-decoration: none;
        border-radius: var(--radius-sm);
        font-size: var(--font-sm);
        font-weight: var(--font-medium);
        transition: all 0.2s ease;
        box-shadow: var(--shadow-xs);
        border: 1px solid #d1d5db;
      }

      .reset-link:hover {
        background: #f9fafb;
        transform: translateY(-1px);
        box-shadow: var(--shadow-hover);
      }

      /* Mode Toggle */
      .mode-controls {
        margin-bottom: var(--space-6);
      }

      .mode-toggle {
        display: inline-flex;
        background: #e2e8f0;
        border-radius: var(--radius-sm);
        padding: var(--space-1);
        margin-bottom: var(--space-4);
      }

      .mode-btn {
        padding: var(--space-2) var(--space-3);
        border: none;
        background: transparent;
        border-radius: var(--radius-sm);
        cursor: pointer;
        font-weight: var(--font-medium);
        transition: all 0.2s ease;
        font-size: var(--font-sm);
        color: var(--dark);
        white-space: nowrap;
      }

      .mode-btn.active {
        background: var(--white);
        color: var(--primary);
        box-shadow: var(--shadow-sm);
      }

      .mode-btn:hover:not(.active) {
        background: rgba(255, 255, 255, 0.5);
      }

      /* Custom Questions Panel */
      .custom-panel {
        background: #f8fafc;
        border-radius: var(--radius-md);
        border: 1px solid #e5e7eb;
        padding: var(--space-6);
        margin-bottom: var(--space-6);
        max-width: 800px;
        width: 100%;
        margin-left: auto;
        margin-right: auto;
      }

      .custom-header {
        text-align: center;
        margin-bottom: var(--space-6);
      }

      .custom-header h3 {
        font-size: var(--font-xl);
        font-weight: var(--font-semibold);
        color: var(--dark);
        margin-bottom: var(--space-2);
      }

      .custom-header p {
        color: #666;
        font-size: var(--font-base);
        margin-bottom: var(--space-3);
      }

      .questions-progress {
        display: inline-block;
        background: #e0e7ff;
        color: #3730a3;
        padding: var(--space-2) var(--space-3);
        border-radius: var(--radius-sm);
        font-size: var(--font-sm);
        font-weight: var(--font-medium);
      }

      .questions-progress.complete {
        background: #dcfce7;
        color: #166534;
      }

      .add-question-form {
        background: var(--white);
        border-radius: var(--radius-md);
        padding: var(--space-6);
        margin-bottom: var(--space-6);
      }

      .form-group {
        margin-bottom: var(--space-4);
      }

      .form-group label {
        display: block;
        font-weight: var(--font-medium);
        color: var(--dark);
        margin-bottom: var(--space-2);
        font-size: var(--font-sm);
      }

      .form-group textarea,
      .form-group input[type="text"] {
        width: 100%;
        padding: var(--space-3);
        border: 1px solid #d1d5db;
        border-radius: var(--radius-sm);
        font-size: var(--font-base);
        font-family: inherit;
        transition: border-color 0.2s ease;
      }

      .form-group textarea:focus,
      .form-group input[type="text"]:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(111, 196, 238, 0.1);
      }

      .options-inputs {
        display: grid;
        gap: var(--space-3);
      }

      .option-input {
        display: flex;
        align-items: center;
        gap: var(--space-3);
        background: var(--white);
        padding: var(--space-3);
        border-radius: var(--radius-sm);
        border: 1px solid #e5e7eb;
      }

      .option-input input[type="text"] {
        flex: 1;
        margin: 0;
        border: 1px solid #d1d5db;
      }

      .option-input input[type="radio"] {
        margin: 0;
      }

      .option-input label {
        font-size: var(--font-sm);
        font-weight: var(--font-medium);
        color: var(--success);
        margin: 0;
        cursor: pointer;
      }

      .add-question-btn {
        width: 100%;
        padding: var(--space-3) var(--space-4);
        background: var(--success);
        color: var(--white);
        border: none;
        border-radius: var(--radius-sm);
        font-size: var(--font-base);
        font-weight: var(--font-medium);
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .add-question-btn:hover {
        background: #7bb653;
        transform: translateY(-1px);
        box-shadow: var(--shadow-hover);
      }

      .add-question-btn:disabled {
        background: #d1d5db;
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }

      .save-load-controls {
        display: flex;
        gap: var(--space-2);
        justify-content: center;
        margin-bottom: var(--space-6);
        flex-wrap: wrap;
      }

      .save-btn,
      .load-btn {
        padding: var(--space-2) var(--space-4);
        border: 1px solid #d1d5db;
        background: var(--white);
        color: var(--dark);
        border-radius: var(--radius-sm);
        cursor: pointer;
        font-size: var(--font-sm);
        font-weight: var(--font-medium);
        transition: all 0.2s ease;
        box-shadow: var(--shadow-xs);
      }

      .save-btn:hover,
      .load-btn:hover {
        background: #f9fafb;
        border-color: #9ca3af;
        transform: translateY(-1px);
        box-shadow: var(--shadow-hover);
      }

      .file-input {
        display: none;
      }

      .custom-questions-list h4 {
        font-size: var(--font-lg);
        font-weight: var(--font-semibold);
        color: var(--dark);
        margin-bottom: var(--space-4);
      }

      .questions-list {
        max-height: 300px;
        overflow-y: auto;
      }

      .question-item {
        background: var(--white);
        border: 1px solid #e5e7eb;
        border-radius: var(--radius-sm);
        padding: var(--space-4);
        margin-bottom: var(--space-3);
        position: relative;
      }

      .question-item h5 {
        font-size: var(--font-base);
        font-weight: var(--font-medium);
        color: var(--dark);
        margin-bottom: var(--space-2);
        line-height: var(--leading-snug);
      }

      .question-options {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--space-2);
        font-size: var(--font-sm);
        color: #666;
      }

      .question-options .correct {
        color: var(--success);
        font-weight: var(--font-medium);
      }

      .delete-question {
        position: absolute;
        top: var(--space-2);
        right: var(--space-2);
        background: var(--error);
        color: var(--white);
        border: none;
        border-radius: 50%;
        width: 24px;
        height: 24px;
        cursor: pointer;
        font-size: var(--font-xs);
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
      }

      .delete-question:hover {
        background: #d63749;
        transform: scale(1.1);
      }

      .empty-state {
        text-align: center;
        color: #9ca3af;
        font-style: italic;
        padding: var(--space-8);
      }

      /* Bingo Grid Container */
      .bingo-grid-container {
        display: flex;
        justify-content: center;
        margin-top: var(--space-6);
      }

      .bingo-grid {
        display: grid;
        grid-template-columns: repeat(5, 1fr);
        gap: var(--space-3);
        max-width: 500px;
        margin: 0 auto;
      }

      .bingo-cell {
        background: var(--white);
        border: 2px solid #e5e7eb;
        border-radius: var(--radius-sm);
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        font-size: var(--font-lg);
        font-weight: var(--font-semibold);
        width: 80px;
        height: 80px;
        cursor: pointer;
        transition: all 0.2s ease;
        position: relative;
        box-shadow: var(--shadow-xs);
      }

      .bingo-cell:hover:not(.correct):not(.disabled):not(.free) {
        border-color: var(--primary);
        box-shadow: var(--shadow-hover);
        transform: translateY(-2px);
      }

      .bingo-cell.correct {
        background: var(--success);
        color: var(--white);
        border-color: var(--success);
      }

      .bingo-cell.disabled {
        background: #f3f4f6;
        color: #9ca3af;
        border-color: #d1d5db;
        cursor: not-allowed;
      }

      .bingo-cell.free {
        background: var(--primary);
        color: var(--white);
        border-color: var(--primary);
        cursor: default;
        font-weight: var(--font-bold);
      }

      .question-mark {
        width: 24px;
        height: 24px;
        opacity: 0.6;
      }

      /* Modal Styles */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(37, 38, 38, 0.6);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        display: none;
        z-index: 300;
        align-items: center;
        justify-content: center;
      }

      .modal {
        background: var(--white);
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-active);
        padding: var(--space-8);
        max-width: 600px;
        width: 90%;
        max-height: 80vh;
        overflow-y: auto;
      }

      .modal h2 {
        font-size: var(--font-xl);
        font-weight: var(--font-semibold);
        color: var(--dark);
        margin-bottom: var(--space-6);
        line-height: var(--leading-snug);
      }

      .modal-options {
        display: grid;
        gap: var(--space-3);
      }

      .option-button {
        padding: var(--space-4) var(--space-5);
        background: #f8fafc;
        border: 2px solid #e5e7eb;
        border-radius: var(--radius-sm);
        font-size: var(--font-base);
        font-weight: var(--font-medium);
        color: var(--dark);
        cursor: pointer;
        transition: all 0.2s ease;
        text-align: left;
      }

      .option-button:hover {
        background: #f1f5f9;
        border-color: var(--primary);
        transform: translateY(-1px);
        box-shadow: var(--shadow-hover);
      }

      /* Instructions Modal */
      .instructions-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(37, 38, 38, 0.4);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        display: none;
        z-index: 300;
        align-items: center;
        justify-content: center;
        opacity: 0;
        visibility: hidden;
        transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
      }

      .instructions-overlay.active {
        opacity: 1;
        visibility: visible;
      }

      .instructions-modal {
        background: var(--white);
        border-radius: var(--radius-lg);
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25),
          0 10px 20px rgba(0, 0, 0, 0.1);
        padding: var(--space-8);
        max-width: 500px;
        width: 90%;
        max-height: 80vh;
        overflow-y: auto;
        position: relative;
        transform: translateY(20px);
        transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
      }

      .instructions-overlay.active .instructions-modal {
        transform: translateY(0);
      }

      .instructions-modal h2 {
        font-size: var(--font-2xl);
        font-weight: var(--font-semibold);
        color: var(--dark);
        margin-bottom: var(--space-6);
        text-align: center;
        letter-spacing: -0.04em;
      }

      .instructions-content {
        font-size: var(--font-base);
        line-height: var(--leading-relaxed);
        color: #4b5563;
      }

      .instructions-step {
        display: flex;
        align-items: flex-start;
        margin-bottom: var(--space-4);
        padding: var(--space-4);
        background: #f8fafc;
        border-radius: var(--radius-sm);
        border-left: 4px solid var(--primary);
      }

      .step-number {
        background: var(--primary);
        color: var(--white);
        border-radius: 50%;
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: var(--font-sm);
        font-weight: var(--font-semibold);
        margin-right: var(--space-3);
        flex-shrink: 0;
      }

      .step-text {
        flex: 1;
        font-weight: var(--font-medium);
        color: var(--dark);
      }

      .instructions-note {
        background: #dcfce7;
        color: #166534;
        padding: var(--space-4);
        border-radius: var(--radius-sm);
        margin-top: var(--space-4);
        font-size: var(--font-sm);
        font-weight: var(--font-medium);
        text-align: center;
      }

      .instructions-close {
        position: absolute;
        top: var(--space-4);
        right: var(--space-4);
        background: #f3f4f6;
        border: none;
        border-radius: 50%;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.2s ease;
        color: #6b7280;
      }

      .instructions-close:hover {
        background: #e5e7eb;
        color: var(--dark);
        transform: scale(1.1);
      }

      .instructions-close::before {
        content: "×";
        font-size: var(--font-lg);
        font-weight: var(--font-semibold);
        line-height: 1;
      }

      /* Footer */
      .footer {
        background: var(--dark);
        color: var(--white);
        padding: var(--space-8) var(--space-4) var(--space-6);
        text-align: center;
        flex-shrink: 0;
      }

      .footer p {
        opacity: 0.8;
        font-size: var(--font-sm);
      }

      /* Responsive Design */
      @media (max-width: 640px) {
        .nav-desktop {
          display: none;
        }

        .nav-mobile {
          display: block;
        }

        .main {
          padding: var(--space-4) var(--space-3);
          padding-top: calc(var(--space-4) + 60px);
        }

        .game-header h1 {
          font-size: var(--font-3xl);
        }

        .game-container {
          padding: var(--space-6);
        }

        .bingo-grid {
          gap: var(--space-2);
        }

        .bingo-cell {
          width: 60px;
          height: 60px;
          font-size: var(--font-base);
        }

        .modal {
          padding: var(--space-6);
        }
      }

      @media (min-width: 641px) {
        .nav-desktop {
          display: block;
        }

        .nav-mobile {
          display: none;
        }
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <header class="header">
      <nav class="nav">
        <div class="nav-left">
          <button class="menu-button" id="menuButton">
            <div class="menu-line"></div>
            <div class="menu-line"></div>
          </button>
        </div>
        <div class="nav-center">
          <a href="/" class="logo">
            <svg
              class="logo-icon"
              viewBox="0 0 111.19 111.19"
              xmlns="http://www.w3.org/2000/svg"
            >
              <defs>
                <style>
                  .cls-1 {
                    fill: #6fc4ee;
                  }
                  .cls-2 {
                    fill: #ffcd2f;
                  }
                  .cls-3 {
                    fill: #9579b3;
                  }
                  .cls-4 {
                    fill: #ef4a88;
                  }
                </style>
              </defs>
              <g id="Layer_1-2" data-name="Layer 1">
                <g>
                  <rect
                    class="cls-1"
                    width="53.6"
                    height="53.6"
                    rx="12"
                    ry="12"
                  />
                  <rect
                    class="cls-2"
                    x="57.6"
                    y="57.6"
                    width="53.6"
                    height="53.6"
                    rx="26.8"
                    ry="26.8"
                  />
                  <path
                    class="cls-3"
                    d="M29.39,111.19c-1.62,0-3.22-.6-4.46-1.77-2.09-1.96-2.64-5.07-1.36-7.63l5.72-11.48-19.54,11.28c-2.47,1.43-5.59,1.07-7.68-.87-2.09-1.95-2.67-5.03-1.42-7.6l6.14-12.64c-2.31.09-4.62-1.09-5.86-3.25-1.79-3.11-.73-7.08,2.38-8.88l14.76-8.52c2.47-1.43,5.59-1.07,7.68.87,2.09,1.95,2.67,5.03,1.42,7.6l-5.55,11.42,19.87-11.47c2.48-1.44,5.62-1.07,7.7.89,2.09,1.96,2.64,5.07,1.36,7.63l-6.22,12.47c2.42-.21,4.88.97,6.18,3.23,1.79,3.11.73,7.08-2.38,8.88l-15.5,8.95c-1.01.58-2.13.87-3.25.87Z"
                  />
                  <path
                    class="cls-4"
                    d="M96.54,26.8l12.14-12.14c3.35-3.35,3.35-8.79,0-12.14-3.35-3.35-8.79-3.35-12.14,0l-12.14,12.14-12.14-12.14c-3.35-3.35-8.79-3.35-12.14,0h0c-3.35,3.35-3.35,8.79,0,12.14l12.14,12.14-12.14,12.14c-3.35,3.35-3.35,8.79,0,12.14h0c3.35,3.35,8.79,3.35,12.14,0l12.14-12.14,12.14,12.14c3.35,3.35,8.79,3.35,12.14,0,3.35-3.35,3.35-8.79,0-12.14l-12.14-12.14Z"
                  />
                </g>
              </g>
            </svg>
            <span class="logo-text">playful</span>
          </a>
        </div>
        <div class="nav-right">
          <!-- Reserved for future features like search -->
        </div>
      </nav>
    </header>

    <!-- Desktop Navigation -->
    <div class="nav-desktop">
      <nav class="sidebar-desktop" id="sidebarDesktop">
        <button class="sidebar-close" id="sidebarCloseDesktop"></button>
        <div class="sidebar-content">
          <div class="sidebar-section">
            <h3>Tools</h3>
            <ul class="sidebar-nav">
              <li><a href="behavior-meter.html">Behavior Meter</a></li>
              <li><a href="weekly-tracker.html">Weekly Tracker</a></li>
              <li>
                <a href="#" style="opacity: 0.5"
                  >Quick Assessment
                  <span style="font-size: 0.7em">(Soon)</span></a
                >
              </li>
              <li>
                <a href="#" style="opacity: 0.5"
                  >Study Planner <span style="font-size: 0.7em">(Soon)</span></a
                >
              </li>
              <li>
                <a href="#" style="opacity: 0.5"
                  >Class Timer <span style="font-size: 0.7em">(Soon)</span></a
                >
              </li>
              <li>
                <a href="#" style="opacity: 0.5"
                  >Goal Tracker <span style="font-size: 0.7em">(Soon)</span></a
                >
              </li>
            </ul>
          </div>

          <div class="sidebar-section">
            <h3>Games</h3>
            <ul class="sidebar-nav">
              <li><a href="trivia-bingo/">Trivia Bingo</a></li>
            </ul>
          </div>

          <div class="sidebar-section">
            <h3>Resources</h3>
            <ul class="sidebar-nav">
              <li>
                <a href="#" style="opacity: 0.5"
                  >Teaching Guides
                  <span style="font-size: 0.7em">(Soon)</span></a
                >
              </li>
              <li>
                <a href="#" style="opacity: 0.5"
                  >Blog <span style="font-size: 0.7em">(Soon)</span></a
                >
              </li>
              <li>
                <a href="#" style="opacity: 0.5"
                  >Templates <span style="font-size: 0.7em">(Soon)</span></a
                >
              </li>
            </ul>
          </div>

          <div class="sidebar-section">
            <h3>About</h3>
            <ul class="sidebar-nav">
              <li><a href="#about">About Us</a></li>
              <li><a href="#contact">Contact</a></li>
              <li><a href="#help">Help & Support</a></li>
            </ul>
          </div>
        </div>
      </nav>
    </div>

    <!-- Mobile Navigation -->
    <div class="nav-mobile">
      <nav class="sidebar-mobile" id="sidebarMobile">
        <button class="sidebar-close" id="sidebarCloseMobile"></button>
        <div class="sidebar-content">
          <div class="sidebar-section">
            <h3>Tools</h3>
            <ul class="sidebar-nav">
              <li><a href="behavior-meter.html">Behavior Meter</a></li>
              <li><a href="weekly-tracker.html">Weekly Tracker</a></li>
              <li>
                <a href="#" style="opacity: 0.5"
                  >Quick Assessment
                  <span style="font-size: 0.7em">(Soon)</span></a
                >
              </li>
              <li>
                <a href="#" style="opacity: 0.5"
                  >Study Planner <span style="font-size: 0.7em">(Soon)</span></a
                >
              </li>
              <li>
                <a href="#" style="opacity: 0.5"
                  >Class Timer <span style="font-size: 0.7em">(Soon)</span></a
                >
              </li>
              <li>
                <a href="#" style="opacity: 0.5"
                  >Goal Tracker <span style="font-size: 0.7em">(Soon)</span></a
                >
              </li>
            </ul>
          </div>

          <div class="sidebar-section">
            <h3>Games</h3>
            <ul class="sidebar-nav">
              <li><a href="trivia-bingo/">Trivia Bingo</a></li>
            </ul>
          </div>

          <div class="sidebar-section">
            <h3>Resources</h3>
            <ul class="sidebar-nav">
              <li>
                <a href="#" style="opacity: 0.5"
                  >Teaching Guides
                  <span style="font-size: 0.7em">(Soon)</span></a
                >
              </li>
              <li>
                <a href="#" style="opacity: 0.5"
                  >Blog <span style="font-size: 0.7em">(Soon)</span></a
                >
              </li>
              <li>
                <a href="#" style="opacity: 0.5"
                  >Templates <span style="font-size: 0.7em">(Soon)</span></a
                >
              </li>
            </ul>
          </div>

          <div class="sidebar-section">
            <h3>About</h3>
            <ul class="sidebar-nav">
              <li><a href="#about">About Us</a></li>
              <li><a href="#contact">Contact</a></li>
              <li><a href="#help">Help & Support</a></li>
            </ul>
          </div>
        </div>
      </nav>
    </div>

    <!-- Overlay -->
    <div class="overlay" id="overlay"></div>

    <!-- Main Content -->
    <main class="main">
      <div class="game-content">
        <div class="game-container animate gentleSettle delay-1">
          <div class="game-header">
            <h1>Trivia Bingo</h1>
            <p class="game-subtitle">
              Test your knowledge and get five in a row!
            </p>

            <!-- Mode Toggle -->
            <div class="mode-controls">
              <div class="mode-toggle">
                <button class="mode-btn active" onclick="setMode('default')">
                  Default Questions
                </button>
                <button class="mode-btn" onclick="setMode('custom')">
                  Custom Questions
                </button>
              </div>
            </div>

            <div class="game-instructions">
              <a href="#" class="instruction-link" onclick="showInstructions()"
                >How to Play</a
              >
              <a href="#" class="reset-link" onclick="resetGame()"
                >Reset Game</a
              >
            </div>
          </div>

          <!-- Custom Questions Panel -->
          <div class="custom-panel" id="customPanel" style="display: none">
            <div class="custom-header">
              <h3>Manage Custom Questions</h3>
              <p>Add your own trivia questions for the game</p>
              <div class="questions-progress" id="questionsProgress">
                Need 24 questions to play (0/24)
              </div>
            </div>

            <div class="add-question-form">
              <div class="form-group">
                <label for="questionInput">Question:</label>
                <textarea
                  id="questionInput"
                  placeholder="Enter your trivia question..."
                  rows="2"
                ></textarea>
              </div>

              <div class="form-group">
                <label>Answer Options:</label>
                <div class="options-inputs">
                  <div class="option-input">
                    <input type="text" id="option1" placeholder="Option 1" />
                    <input
                      type="radio"
                      name="correctAnswer"
                      value="0"
                      id="correct1"
                    />
                    <label for="correct1">Correct</label>
                  </div>
                  <div class="option-input">
                    <input type="text" id="option2" placeholder="Option 2" />
                    <input
                      type="radio"
                      name="correctAnswer"
                      value="1"
                      id="correct2"
                    />
                    <label for="correct2">Correct</label>
                  </div>
                  <div class="option-input">
                    <input type="text" id="option3" placeholder="Option 3" />
                    <input
                      type="radio"
                      name="correctAnswer"
                      value="2"
                      id="correct3"
                    />
                    <label for="correct3">Correct</label>
                  </div>
                  <div class="option-input">
                    <input type="text" id="option4" placeholder="Option 4" />
                    <input
                      type="radio"
                      name="correctAnswer"
                      value="3"
                      id="correct4"
                    />
                    <label for="correct4">Correct</label>
                  </div>
                </div>
              </div>

              <button class="add-question-btn" onclick="addCustomQuestion()">
                Add Question
              </button>
            </div>

            <div class="save-load-controls">
              <button class="save-btn" onclick="saveQuestions()">
                💾 Save Questions
              </button>
              <button
                class="load-btn"
                onclick="document.getElementById('questionsFileInput').click()"
              >
                📁 Load Questions
              </button>
              <input
                type="file"
                id="questionsFileInput"
                class="file-input"
                accept=".json"
                onchange="loadQuestions(event)"
              />
            </div>

            <div class="custom-questions-list">
              <h4>Your Questions (<span id="questionCount">0</span>)</h4>
              <div id="questionsList" class="questions-list">
                <!-- Custom questions will appear here -->
              </div>
            </div>
          </div>

          <!-- Bingo Grid -->
          <div class="bingo-grid-container">
            <div class="bingo-grid" id="bingoGrid">
              <!-- Grid cells will be generated by JavaScript -->
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Modal for Questions -->
    <div class="modal-overlay" id="modalOverlay">
      <div class="modal">
        <h2 id="questionText"></h2>
        <div class="modal-options" id="modalOptions">
          <!-- Options will be generated by JavaScript -->
        </div>
      </div>
    </div>

    <!-- Instructions Modal -->
    <div class="instructions-overlay" id="instructionsOverlay">
      <div class="instructions-modal">
        <button class="instructions-close" id="instructionsClose"></button>
        <h2>How to Play Trivia Bingo</h2>
        <div class="instructions-content">
          <div class="instructions-step">
            <div class="step-number">1</div>
            <div class="step-text">
              Click any square to reveal a trivia question
            </div>
          </div>
          <div class="instructions-step">
            <div class="step-number">2</div>
            <div class="step-text">
              Choose the correct answer from multiple choices
            </div>
          </div>
          <div class="instructions-step">
            <div class="step-number">3</div>
            <div class="step-text">
              Correct answers turn the square green (✓)
            </div>
          </div>
          <div class="instructions-step">
            <div class="step-number">4</div>
            <div class="step-text">Wrong answers turn the square gray (✗)</div>
          </div>
          <div class="instructions-step">
            <div class="step-number">5</div>
            <div class="step-text">
              Get five correct answers in a row (horizontal, vertical, or
              diagonal) to win!
            </div>
          </div>
          <div class="instructions-note">
            💡 The center square is FREE and counts toward your bingo. Good
            luck!
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <p>
        &copy; 2025 Playful Creative Works. Designed for educators, by
        educators.
      </p>
    </footer>

    <script>
      // Sidebar functionality
      const menuButton = document.getElementById("menuButton");
      const sidebarDesktop = document.getElementById("sidebarDesktop");
      const sidebarMobile = document.getElementById("sidebarMobile");
      const sidebarCloseDesktop = document.getElementById(
        "sidebarCloseDesktop"
      );
      const sidebarCloseMobile = document.getElementById("sidebarCloseMobile");
      const overlay = document.getElementById("overlay");

      function isMobile() {
        return window.innerWidth <= 640;
      }

      function toggleSidebar() {
        if (isMobile()) {
          const isOpen = sidebarMobile.classList.contains("open");
          if (isOpen) {
            sidebarMobile.classList.remove("open");
            overlay.classList.remove("active");
            document.body.style.overflow = "";
          } else {
            sidebarMobile.classList.add("open");
            overlay.classList.add("active");
            document.body.style.overflow = "hidden";
          }
        } else {
          const isOpen = sidebarDesktop.classList.contains("open");
          if (isOpen) {
            sidebarDesktop.classList.remove("open");
            overlay.classList.remove("active");
            document.body.overflow = "";
          } else {
            sidebarDesktop.classList.add("open");
            overlay.classList.add("active");
            document.body.style.overflow = "hidden";
          }
        }
      }

      function closeSidebar() {
        sidebarDesktop.classList.remove("open");
        sidebarMobile.classList.remove("open");
        overlay.classList.remove("active");
        document.body.style.overflow = "";
      }

      menuButton.addEventListener("click", toggleSidebar);
      sidebarCloseDesktop.addEventListener("click", closeSidebar);
      sidebarCloseMobile.addEventListener("click", closeSidebar);
      overlay.addEventListener("click", closeSidebar);

      document.addEventListener("keydown", function (e) {
        if (
          e.key === "Escape" &&
          (sidebarDesktop.classList.contains("open") ||
            sidebarMobile.classList.contains("open"))
        ) {
          closeSidebar();
        }
      });

      // Remove animation classes after animations complete
      document.querySelectorAll(".animate.gentleSettle").forEach((element) => {
        element.addEventListener("animationend", () => {
          element.classList.remove("animate", "gentleSettle");
        });
      });

      // Trivia Questions (Educational themes)
      const triviaQuestions = [
        {
          question: "What is the closest planet to the Sun?",
          answer: "Mercury",
          options: ["Venus", "Mercury", "Mars", "Earth"],
        },
        {
          question: "Which process do plants use to make their own food?",
          answer: "Photosynthesis",
          options: [
            "Respiration",
            "Photosynthesis",
            "Digestion",
            "Circulation",
          ],
        },
        {
          question: "What is the largest mammal in the world?",
          answer: "Blue whale",
          options: ["African elephant", "Blue whale", "Giraffe", "Polar bear"],
        },
        {
          question: "In what year did World War II end?",
          answer: "1945",
          options: ["1943", "1944", "1945", "1946"],
        },
        {
          question: "What is the capital of Australia?",
          answer: "Canberra",
          options: ["Sydney", "Melbourne", "Canberra", "Perth"],
        },
        {
          question: "Which element has the chemical symbol 'O'?",
          answer: "Oxygen",
          options: ["Gold", "Oxygen", "Silver", "Iron"],
        },
        {
          question: "Who wrote the play 'Romeo and Juliet'?",
          answer: "William Shakespeare",
          options: [
            "Charles Dickens",
            "William Shakespeare",
            "Mark Twain",
            "Jane Austen",
          ],
        },
        {
          question: "What is 7 × 8?",
          answer: "56",
          options: ["54", "56", "58", "64"],
        },
        {
          question: "Which continent is the Sahara Desert located on?",
          answer: "Africa",
          options: ["Asia", "Africa", "Australia", "South America"],
        },
        {
          question: "What gas do humans breathe out?",
          answer: "Carbon dioxide",
          options: ["Oxygen", "Nitrogen", "Carbon dioxide", "Hydrogen"],
        },
        {
          question: "How many sides does a hexagon have?",
          answer: "6",
          options: ["5", "6", "7", "8"],
        },
        {
          question: "Which ocean is the largest?",
          answer: "Pacific Ocean",
          options: [
            "Atlantic Ocean",
            "Indian Ocean",
            "Pacific Ocean",
            "Arctic Ocean",
          ],
        },
        {
          question: "What is the smallest unit of matter?",
          answer: "Atom",
          options: ["Molecule", "Cell", "Atom", "Electron"],
        },
        {
          question: "In which country would you find Machu Picchu?",
          answer: "Peru",
          options: ["Brazil", "Chile", "Peru", "Ecuador"],
        },
        {
          question: "What is the past tense of 'run'?",
          answer: "Ran",
          options: ["Run", "Running", "Ran", "Runs"],
        },
        {
          question: "Which instrument measures temperature?",
          answer: "Thermometer",
          options: ["Barometer", "Thermometer", "Speedometer", "Hygrometer"],
        },
        {
          question: "What is the main ingredient in bread?",
          answer: "Flour",
          options: ["Sugar", "Salt", "Flour", "Water"],
        },
        {
          question: "How many minutes are in an hour?",
          answer: "60",
          options: ["50", "60", "70", "100"],
        },
        {
          question: "Which planet is known as the 'Red Planet'?",
          answer: "Mars",
          options: ["Venus", "Mars", "Jupiter", "Saturn"],
        },
        {
          question: "What do you call a baby frog?",
          answer: "Tadpole",
          options: ["Froglet", "Tadpole", "Polliwog", "Spawn"],
        },
        {
          question: "Which season comes after winter?",
          answer: "Spring",
          options: ["Summer", "Fall", "Spring", "Autumn"],
        },
        {
          question: "What is the largest continent?",
          answer: "Asia",
          options: ["Africa", "North America", "Asia", "Europe"],
        },
        {
          question: "How many legs does a spider have?",
          answer: "8",
          options: ["6", "8", "10", "12"],
        },
        {
          question: "What is the freezing point of water in Celsius?",
          answer: "0°C",
          options: ["-1°C", "0°C", "1°C", "32°C"],
        },
      ];

      // Game state
      let gameGrid = [];
      let usedQuestions = [];
      let currentMode = "default";
      let customQuestions = [];

      // Mode switching
      function setMode(mode) {
        currentMode = mode;
        setModeUI(mode);

        const customPanel = document.getElementById("customPanel");
        if (mode === "custom") {
          customPanel.style.display = "block";
        } else {
          customPanel.style.display = "none";
        }

        // Reset game when switching modes
        initializeGame();
      }

      function setModeUI(mode) {
        document.querySelectorAll(".mode-btn").forEach((btn) => {
          btn.classList.remove("active");
          if (
            (mode === "default" && btn.textContent.includes("Default")) ||
            (mode === "custom" && btn.textContent.includes("Custom"))
          ) {
            btn.classList.add("active");
          }
        });
      }

      // Custom questions management
      function addCustomQuestion() {
        const questionInput = document.getElementById("questionInput");
        const option1 = document.getElementById("option1");
        const option2 = document.getElementById("option2");
        const option3 = document.getElementById("option3");
        const option4 = document.getElementById("option4");
        const correctAnswer = document.querySelector(
          'input[name="correctAnswer"]:checked'
        );

        // Validation
        if (!questionInput.value.trim()) {
          alert("Please enter a question.");
          return;
        }

        const options = [
          option1.value.trim(),
          option2.value.trim(),
          option3.value.trim(),
          option4.value.trim(),
        ];
        if (options.some((opt) => !opt)) {
          alert("Please fill in all four answer options.");
          return;
        }

        if (!correctAnswer) {
          alert("Please select which answer is correct.");
          return;
        }

        // Create question object
        const newQuestion = {
          question: questionInput.value.trim(),
          answer: options[parseInt(correctAnswer.value)],
          options: options,
          id: Date.now(), // Simple ID generation
        };

        // Add to custom questions
        customQuestions.push(newQuestion);

        // Clear form
        questionInput.value = "";
        option1.value = "";
        option2.value = "";
        option3.value = "";
        option4.value = "";
        document.querySelector(
          'input[name="correctAnswer"]:checked'
        ).checked = false;

        // Update display
        updateCustomQuestionsList();
        initializeGame(); // Reset game with new questions
      }

      function deleteCustomQuestion(id) {
        if (confirm("Are you sure you want to delete this question?")) {
          customQuestions = customQuestions.filter((q) => q.id !== id);
          updateCustomQuestionsList();
          initializeGame(); // Reset game
        }
      }

      function updateCustomQuestionsList() {
        const questionsList = document.getElementById("questionsList");
        const questionCount = document.getElementById("questionCount");
        const questionsProgress = document.getElementById("questionsProgress");

        questionCount.textContent = customQuestions.length;

        // Update progress indicator
        const required = 24;
        const current = customQuestions.length;
        const isComplete = current >= required;

        questionsProgress.textContent = isComplete
          ? `Ready to play! (${current}/${required})`
          : `Need ${required} questions to play (${current}/${required})`;

        questionsProgress.className = isComplete
          ? "questions-progress complete"
          : "questions-progress";

        if (customQuestions.length === 0) {
          questionsList.innerHTML =
            '<div class="empty-state">No custom questions yet. Add some above!</div>';
          return;
        }

        questionsList.innerHTML = customQuestions
          .map(
            (q) => `
          <div class="question-item">
            <button class="delete-question" onclick="deleteCustomQuestion(${
              q.id
            })">×</button>
            <h5>${q.question}</h5>
            <div class="question-options">
              ${q.options
                .map(
                  (opt) =>
                    `<span class="${
                      opt === q.answer ? "correct" : ""
                    }">${opt}</span>`
                )
                .join("")}
            </div>
          </div>
        `
          )
          .join("");
      }

      // Save and Load Custom Questions
      function saveQuestions() {
        if (customQuestions.length === 0) {
          showMessage(
            "No custom questions to save! Add some questions first.",
            "error"
          );
          return;
        }

        const saveData = {
          questions: customQuestions,
          timestamp: new Date().toISOString(),
          version: "1.0",
          totalQuestions: customQuestions.length,
        };

        const dataStr = JSON.stringify(saveData, null, 2);
        const dataBlob = new Blob([dataStr], { type: "application/json" });

        const link = document.createElement("a");
        link.href = URL.createObjectURL(dataBlob);
        link.download = `trivia-questions-${
          new Date().toISOString().split("T")[0]
        }.json`;
        link.click();

        showMessage(
          `${customQuestions.length} questions saved! File downloaded to your computer.`,
          "success"
        );
      }

      function loadQuestions(event) {
        const file = event.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function (e) {
          try {
            const loadedData = JSON.parse(e.target.result);

            // Validate file structure
            if (!loadedData.questions || !Array.isArray(loadedData.questions)) {
              throw new Error("Invalid file format - missing questions array");
            }

            // Validate each question has required properties
            const invalidQuestions = loadedData.questions.filter(
              (q) =>
                !q.question ||
                !q.answer ||
                !q.options ||
                !Array.isArray(q.options) ||
                q.options.length !== 4
            );

            if (invalidQuestions.length > 0) {
              throw new Error("Some questions are missing required fields");
            }

            // Assign new IDs to prevent conflicts
            const questionsWithNewIds = loadedData.questions.map((q) => ({
              ...q,
              id: Date.now() + Math.random(), // Ensure unique IDs
            }));

            // Add to existing questions (or replace if user confirms)
            if (customQuestions.length > 0) {
              const replace = confirm(
                `You have ${customQuestions.length} existing questions. Do you want to replace them with the ${questionsWithNewIds.length} loaded questions?\n\nClick OK to replace, or Cancel to add to existing questions.`
              );

              if (replace) {
                customQuestions = questionsWithNewIds;
              } else {
                customQuestions = [...customQuestions, ...questionsWithNewIds];
              }
            } else {
              customQuestions = questionsWithNewIds;
            }

            // Update UI
            updateCustomQuestionsList();
            initializeGame(); // Reset game with new questions

            showMessage(
              `Successfully loaded ${questionsWithNewIds.length} questions!`,
              "success"
            );
          } catch (error) {
            console.error("Error loading questions:", error);
            showMessage(
              "Error loading file. Please make sure it's a valid trivia questions file.",
              "error"
            );
          }
        };
        reader.readAsText(file);

        // Clear the file input
        event.target.value = "";
      }

      function showMessage(text, type) {
        const message = document.createElement("div");
        message.style.cssText = `
          position: fixed;
          top: 20px;
          right: 20px;
          padding: 12px 20px;
          border-radius: 12px;
          color: white;
          font-weight: 500;
          z-index: 1000;
          animation: slideIn 0.3s ease;
          max-width: 300px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        `;

        if (type === "success") {
          message.style.background = "#8dc757";
        } else {
          message.style.background = "#ef4a88";
        }

        message.textContent = text;
        document.body.appendChild(message);

        setTimeout(() => {
          message.style.animation = "slideOut 0.3s ease";
          setTimeout(() => {
            if (message.parentNode) {
              message.parentNode.removeChild(message);
            }
          }, 300);
        }, 3000);
      }

      // Get current question set
      function getCurrentQuestions() {
        if (currentMode === "custom") {
          return customQuestions;
        }
        return triviaQuestions;
      }

      // Initialize game
      function initializeGame() {
        const grid = document.getElementById("bingoGrid");
        grid.innerHTML = "";
        gameGrid = [];
        usedQuestions = [];

        // Check if we have questions available
        const currentQuestions = getCurrentQuestions();
        if (currentMode === "custom" && currentQuestions.length < 24) {
          // Need at least 24 questions for a full game (25 cells minus 1 free)
          if (currentQuestions.length === 0) {
            grid.innerHTML =
              '<div style="grid-column: 1 / -1; text-align: center; color: #9ca3af; padding: 2rem;">Add some custom questions to start playing!</div>';
            return;
          } else {
            const needed = 24 - currentQuestions.length;
            grid.innerHTML = `<div style="grid-column: 1 / -1; text-align: center; color: #9ca3af; padding: 2rem;">You need ${needed} more questions to play. Add them in the form above.</div>`;
            return;
          }
        }

        // Create 5x5 grid
        for (let i = 0; i < 25; i++) {
          const cell = document.createElement("div");
          cell.classList.add("bingo-cell");

          // Middle cell is FREE
          if (i === 12) {
            cell.classList.add("free");
            cell.textContent = "FREE";
            gameGrid[i] = { type: "free" };
          } else {
            cell.innerHTML =
              '<svg class="question-mark" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"/></svg>';

            cell.addEventListener("click", () => handleCellClick(i));
            gameGrid[i] = { type: "question", answered: false };
          }

          grid.appendChild(cell);
        }
      }

      // Handle cell click
      function handleCellClick(index) {
        const cell = document.querySelector(
          `#bingoGrid .bingo-cell:nth-child(${index + 1})`
        );

        if (
          cell.classList.contains("correct") ||
          cell.classList.contains("disabled") ||
          cell.classList.contains("free")
        ) {
          return;
        }

        // Get current question set
        const currentQuestions = getCurrentQuestions();

        // Get random question
        const availableQuestions = currentQuestions.filter(
          (_, i) => !usedQuestions.includes(i)
        );
        if (availableQuestions.length === 0) {
          alert("No more questions available!");
          return;
        }

        const randomIndex = Math.floor(
          Math.random() * availableQuestions.length
        );
        const question = availableQuestions[randomIndex];
        const originalIndex = currentQuestions.indexOf(question);
        usedQuestions.push(originalIndex);

        showModal(question, (isCorrect) => {
          if (isCorrect) {
            cell.classList.add("correct");
            cell.innerHTML = "✓";
            gameGrid[index].answered = true;
            gameGrid[index].correct = true;
          } else {
            cell.classList.add("disabled");
            cell.innerHTML = "✗";
            gameGrid[index].answered = true;
            gameGrid[index].correct = false;
          }

          checkForBingo();
        });
      }

      // Show modal with question
      function showModal(question, callback) {
        const modalOverlay = document.getElementById("modalOverlay");
        const questionText = document.getElementById("questionText");
        const modalOptions = document.getElementById("modalOptions");

        questionText.textContent = question.question;
        modalOptions.innerHTML = "";

        question.options.forEach((option) => {
          const button = document.createElement("button");
          button.className = "option-button";
          button.textContent = option;

          button.onclick = () => {
            const isCorrect = option === question.answer;
            modalOverlay.style.display = "none";
            callback(isCorrect);
          };

          modalOptions.appendChild(button);
        });

        modalOverlay.style.display = "flex";
      }

      // Check for bingo
      function checkForBingo() {
        const winningLines = [
          // Rows
          [0, 1, 2, 3, 4],
          [5, 6, 7, 8, 9],
          [10, 11, 12, 13, 14],
          [15, 16, 17, 18, 19],
          [20, 21, 22, 23, 24],
          // Columns
          [0, 5, 10, 15, 20],
          [1, 6, 11, 16, 21],
          [2, 7, 12, 17, 22],
          [3, 8, 13, 18, 23],
          [4, 9, 14, 19, 24],
          // Diagonals
          [0, 6, 12, 18, 24],
          [4, 8, 12, 16, 20],
        ];

        for (const line of winningLines) {
          const isWinningLine = line.every((index) => {
            const cell = gameGrid[index];
            return cell.type === "free" || (cell.answered && cell.correct);
          });

          if (isWinningLine) {
            setTimeout(() => {
              alert("BINGO! Congratulations! 🎉");
            }, 500);
            return;
          }
        }
      }

      // Reset game
      function resetGame() {
        if (confirm("Are you sure you want to reset the game?")) {
          initializeGame();
        }
      }

      // Show instructions
      function showInstructions() {
        const instructions = `How to Play Trivia Bingo:

1. Click any square to reveal a trivia question
2. Choose the correct answer from multiple choices
3. Correct answers turn the square green (✓)
4. Wrong answers turn the square gray (✗)
5. Get five correct answers in a row (horizontal, vertical, or diagonal) to win!

The center square is FREE and counts toward your bingo.

Good luck!`;

        alert(instructions);
      }

      // Close modal when clicking overlay
      document.getElementById("modalOverlay").addEventListener("click", (e) => {
        if (e.target.id === "modalOverlay") {
          e.target.style.display = "none";
        }
      });

      // Initialize the game when page loads
      initializeGame();
    </script>
  </body>
</html>
